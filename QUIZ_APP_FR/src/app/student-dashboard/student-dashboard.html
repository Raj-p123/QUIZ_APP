<div class="dashboard-wrapper">

  <!-- üîµ TOP NAVBAR -->
  <header class="top-navbar">

    <div class="nav-left">
      <div class="brand">QuizApp</div>
      <input type="text" placeholder="Find a quiz..." class="search-input">
    </div>

   <div class="nav-center">
  <a routerLink="/activity" routerLinkActive="active">Activity</a>
<a routerLink="/classes" routerLinkActive="active">Classes</a>
<a routerLink="/student-dashboard" routerLinkActive="active">Home</a>
  <a (click)="logout()">Logout</a>
</div>


    <div class="nav-right">

      <!-- üèÜ Achievements -->
      <div class="nav-icon" (click)="toggleAchievements()">
        üèÜ
        <span class="badge" *ngIf="achievements.length">
          {{ achievements.length }}
        </span>

        <div class="dropdown-card" *ngIf="showAchievements">
          <h4>Achievements</h4>

          <div *ngIf="achievements.length; else noAch">
            <div class="dropdown-item"
                 *ngFor="let a of achievements">
              {{ a }}
            </div>
          </div>

          <ng-template #noAch>
            <p class="empty-text">No achievements yet.</p>
          </ng-template>
        </div>
      </div>

      <!-- üîî Notifications -->
      <div class="nav-icon" (click)="toggleNotifications()">
        üîî
        <span class="badge" *ngIf="notifications.length">
          {{ notifications.length }}
        </span>

        <div class="dropdown-card" *ngIf="showNotifications">
          <h4>Notifications</h4>

          <div class="dropdown-item"
               *ngFor="let n of notifications">
            {{ n.message }}
          </div>
        </div>
      </div>

      <!-- üë§ Profile -->
      <div class="profile-circle" (click)="openProfile()">
        {{ studentName?.charAt(0) }}
      </div>

    </div>
  </header>

  <!-- üî• WELCOME -->
  <section class="welcome-section">
    <h2>Welcome back, {{ studentName }}!</h2>
  </section>

  <!-- üìä STATS -->
  <section class="stats-row">
    <div class="stat-card">
      <h4>Available Quizzes</h4>
      <span>{{ (dashboardData$ | async)?.totalAvailable }}</span>
    </div>

    <div class="stat-card">
      <h4>Attempted</h4>
      <span>{{ attemptedQuizzes }}</span>
    </div>

    <div class="stat-card">
      <h4>Avg Score</h4>
      <span>{{ averageScore }}%</span>
    </div>

    <div class="stat-card">
      <h4>Highest</h4>
      <span>{{ highestScore }}%</span>
    </div>
  </section>

  <!-- üî∑ GRID CONTENT -->
  <section class="dashboard-grid">

    <!-- LEFT COLUMN -->
    <div class="left-column">

      <!-- FEATURED QUIZZES -->
      <div class="widget-card">
        <div class="section-title-bar">
          <h3>Featured Quizzes</h3>
          <button class="view-all-link"
                  (click)="viewAllQuizzes()">
            View All ‚Üí
          </button>
        </div>

        <div class="quiz-modern-grid">
          <div class="quiz-item-card"
               *ngFor="let q of (dashboardData$ | async)?.visibleQuizzes">

            <div class="card-thumb">
              <img [src]="q.coverImageUrl || 'assets/default-quiz.jpg'">
              <div class="card-tag">New</div>
            </div>

            <div class="card-details">
              <h4>{{ q.title }}</h4>
              <p class="quiz-meta">{{ q.details }}</p>

              <button class="action-btn-primary"
                      (click)="startQuiz(q.id)">
                Start Quiz
              </button>
            </div>

          </div>
        </div>
      </div>

      <!-- üèÜ LEADERBOARD -->
      <div class="widget-card leaderboard-card">
        <h3>üèÜ Global Leaderboard</h3>

        <div class="leader-rows">
          <div class="leader-row"
               *ngFor="let l of leaderboard">

            <div class="rank-badge"
                 [ngClass]="{
                   'gold': l.rank === 1,
                   'silver': l.rank === 2,
                   'bronze': l.rank === 3
                 }">
              {{ l.rank }}
            </div>

            <div class="leader-info">
              <span class="leader-name">{{ l.name }}</span>
              <span class="leader-meta">
                Attempts: {{ l.totalAttempts }} |
                Highest: {{ l.highestScore }}
              </span>
            </div>

            <div class="leader-score">
              {{ l.averageScore }}%
            </div>

          </div>
        </div>
      </div>

    </div> <!-- END LEFT COLUMN -->


    <!-- RIGHT COLUMN -->
    <div class="right-column">

      <app-performance-chart></app-performance-chart>
      <app-subject-analytics></app-subject-analytics>

      <!-- RECOMMENDED -->
      <div class="widget-card">
        <h3>Recommended</h3>

        <div *ngIf="recommended.length === 0">
          No recommended quizzes available.
        </div>

        <div class="rec-card"
             *ngFor="let r of recommended">

          <img [src]="r.coverImageUrl || 'assets/default-quiz.jpg'">

          <div>
            <p>{{ r.title }}</p>
            <small>{{ r.time }}</small>
          </div>

          <button (click)="startQuiz(r.id)">‚ñ∂</button>

        </div>
      </div>

    </div> <!-- END RIGHT COLUMN -->

  </section>

</div>
