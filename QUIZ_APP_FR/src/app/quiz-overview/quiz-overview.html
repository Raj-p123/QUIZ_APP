<div class="overview-page">

  <ng-container *ngIf="quizData$ | async as quiz; else loadingOrError">

    <!-- üî• HEADER -->
    <div class="overview-header">
      <button class="back-btn" (click)="goBack()">‚Üê Back</button>

      <div class="header-text">
        <h1>{{ quiz.title }}</h1>
        <p>{{ quiz.description || 'Test your knowledge and track your progress' }}</p>
      </div>
    </div>

    <!-- üî• STATS -->
    <div class="stats-grid">
      <div class="stat-card">
        <p>Total Questions</p>
        <h2>{{ quiz.totalQuestions }}</h2>
      </div>

      <div class="stat-card">
        <p>Time per Question</p>
        <h2>{{ quiz.timePerQuestionSeconds }} sec</h2>
      </div>

      <div class="stat-card">
        <p>Last Score</p>
        <h2>{{ quiz.lastScore !== null ? quiz.lastScore + '%' : '--' }}</h2>
      </div>

      <div class="stat-card">
        <p>Total Attempts</p>
        <h2>{{ quiz.attempts }}</h2>
      </div>
    </div>

    <!-- üî• START QUIZ CARD -->
    <div class="action-card" *ngIf="!quiz.error">

      <div class="action-info">
        <h4 *ngIf="quiz.attempts === 0">
          You haven‚Äôt attempted this quiz yet
        </h4>

        <h4 *ngIf="quiz.attempts > 0">
          You have attempted this quiz before
        </h4>

        <p class="hint">
          You can attempt this quiz multiple times to improve your score.
        </p>
      </div>

      <button class="start-btn" (click)="startQuiz()">
        Start Quiz
      </button>

    </div>

    <!-- üî• ATTEMPT HISTORY -->
    <div class="history-card" *ngIf="quiz.attemptHistory?.length">

      <h3>Attempt History</h3>

      <div class="attempt-row"
           *ngFor="let attempt of quiz.attemptHistory; let i = index">

        <div class="attempt-left">
          <span class="attempt-badge">
            Attempt {{ i + 1 }}
          </span>
          <span class="attempt-date">
            {{ attempt.date }}
          </span>
        </div>

        <div class="attempt-score">
          {{ attempt.score }}%
        </div>

      </div>

    </div>

    <!-- ERROR -->
    <div *ngIf="quiz.error" class="error-msg">
      Could not load quiz details. Please try again later.
    </div>

  </ng-container>

  <ng-template #loadingOrError>
    <div class="loading-state">
      Fetching quiz details...
    </div>
  </ng-template>

</div>